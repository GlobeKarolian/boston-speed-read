<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Boston.com Speed Read</title>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; margin:0; background:#fafafa; color:#111; }
    .wrap { max-width: 820px; margin: 24px auto; padding: 0 16px; }
    header { text-align:center; margin-bottom: 16px; }
    h1 { margin: 0 0 8px; }
    .meta { color:#666; font-size:13px; }
    .error { background:#fee; border:1px solid #f99; color:#900; padding:10px; border-radius:8px; margin:10px 0; }
    .card { background:#fff; border:1px solid #eee; border-radius: 12px; padding:16px; margin:12px 0; box-shadow: 0 1px 2px rgba(0,0,0,0.04); }
    .title { font-weight:700; font-size: 18px; margin: 0 0 6px; }
    .bullets { margin: 8px 0 0 0; padding-left: 18px; }
    .bullets li { margin: 2px 0; line-height: 1.35; }
    .cta { display:inline-block; margin-top: 8px; font-size: 13px; text-decoration:none; color:#a00; font-weight:600; }
    .hooktype { font-size: 11px; color:#888; margin-left: 6px; }
    .skeleton { background: linear-gradient(90deg, #eee 25%, #f6f6f6 37%, #eee 63%); background-size: 400% 100%; animation: shimmer 1.2s infinite; border-radius:8px; height: 14px; margin: 8px 0; }
    @keyframes shimmer { 0% { background-position: 100% 0; } 100% { background-position: -100% 0; } }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>Boston.com Speed Read</h1>
      <div class="meta" id="updated">Loading…</div>
    </header>
    <div id="errors"></div>
    <div id="list">
      <div class="card"><div class="skeleton" style="width:60%"></div><div class="skeleton"></div><div class="skeleton" style="width:90%"></div></div>
      <div class="card"><div class="skeleton" style="width:50%"></div><div class="skeleton"></div><div class="skeleton" style="width:85%"></div></div>
    </div>
  </div>
  <script>
  function showError(msg) {
    const e = document.getElementById('errors');
    const div = document.createElement('div');
    div.className = 'error';
    div.textContent = msg;
    e.appendChild(div);
  }
  async function load() {
    try {
      const url = new URL('news-data.json', window.location.href).toString();
      const res = await fetch(url, { cache: 'no-cache' });
      if (!res.ok) {
        showError('Could not load news-data.json (' + res.status + '). Commit a placeholder file to fix.');
        document.getElementById('updated').textContent = 'No data.';
        return;
      }
      const data = await res.json();
      document.getElementById('updated').textContent = 'Last updated: ' + (new Date(data.lastUpdated || Date.now())).toLocaleString();
      const list = document.getElementById('list');
      list.innerHTML = '';
      for (const a of (data.articles || [])) {
        const card = document.createElement('div');
        card.className = 'card';
        const h = document.createElement('div');
        h.className = 'title';
        const link = document.createElement('a');
        link.href = a.link; link.textContent = a.title || '(untitled)'; link.target = '_blank'; link.rel = 'noopener';
        h.appendChild(link);
        if (a.hookType) {
          const ht = document.createElement('span');
          ht.className = 'hooktype';
          ht.textContent = '· ' + String(a.hookType).replace('_',' ').toLowerCase();
          h.appendChild(ht);
        }
        const ul = document.createElement('ul'); ul.className = 'bullets';
        (a.summary || []).slice(0,3).forEach(b => {
          const li = document.createElement('li');
          li.textContent = (b || '').replace(/^[-•\s]+/, '');
          ul.appendChild(li);
        });
        card.appendChild(h);
        card.appendChild(ul);
        const cta = document.createElement('a'); cta.className = 'cta'; cta.href = a.link || '#'; cta.target='_blank'; cta.rel='noopener'; cta.textContent = 'Read full story →';
        card.appendChild(cta);
        list.appendChild(card);
      }
      if ((data.articles || []).length === 0) {
        showError('No articles yet. Run the workflow or commit a placeholder news-data.json.');
      }
    } catch (e) {
      console.error(e);
      showError('Error rendering page: ' + e.message);
      document.getElementById('updated').textContent = 'Error.';
    }
  }
  load();
  </script>
</body>
</html>
